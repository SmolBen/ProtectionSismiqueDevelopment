<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CFSS Project Details</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="project-details.css">
    <link rel="stylesheet" href="cfss-project-details.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
</head>
<body class="limited-cfss-page">
    <nav class="navbar">
        <div class="navbar-content">
            <div class="title-area">
                <a href="https://www.protectionsismique2000.com/" class="title">Protection Sismique - CFSS</a>
                <a href="limited-cfss-dashboard.html" class="dashboard-btn">
                    <i class="fas fa-th-large"></i>
                    Dashboard
                </a>
            </div>
            <div class="user-info" id="userInfo">
                <!-- User info will be populated by JavaScript -->
            </div>
        </div>
    </nav>
    
    <div class="loading-project" id="loadingProject">
        <h2>Loading CFSS Project...</h2>
        <p>Please wait while we load the project details.</p>
    </div>
    
    <div class="auth-error" id="authError" style="display: none;">
        <h2>Authentication Required</h2>
        <p>Please log in to view CFSS project details.</p>
        <button onclick="window.location.href='auth.html'">Go to Login</button>
    </div>
    
    <div class="access-denied" id="accessDenied" style="display: none;">
        <h2>Access Denied</h2>
        <p>You don't have permission to view this CFSS project.</p>
        <button onclick="window.location.href='limited-cfss-dashboard.html'">Back to Dashboard</button>
    </div>
    
    <div class="container" id="projectContainer" style="display: none;">
        <!-- Top Half split into two horizontal sections -->
        <div class="top-half">
            <div class="left-section">
                <h1>CFSS Project Details</h1>
                
                <!-- Basic Information (Always Visible) -->
                <div class="basic-info">
                    <p><strong>Project Name:</strong> <span id="projectName"></span></p>
                        <p><strong>Company Name:</strong> <span id="companyName"></span></p>
                        <p><strong>Client Name:</strong> <span id="clientName"></span></p>
                        <p><strong>Description:</strong> <span id="projectDescription"></span></p>
                        <p><strong>Address:</strong> <span id="projectAddress"></span></p>
                        <p><strong>Status:</strong> 
                            <select id="projectStatusDropdown">
                                <option value="Planning">Planning</option>
                                <option value="In Progress">In Progress</option>
                                <option value="Completed">Completed</option>
                            </select>
                        </p>
                </div>
                
                <!-- Floor Table -->
                    <div class="floor-section" style="margin-top: 20px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; border-bottom: 1px solid #17a2b8; padding-bottom: 5px;">
                            <h4 style="margin: 0; color: #17a2b8; font-size: 14px;">Calculs par étage</h4>
                        </div>
                        <table style="width: 100%; border-collapse: collapse; font-size: 12px;">
                            <thead>
                                <tr style="background: #17a2b8; color: white;">
                                    <th style="padding: 8px; text-align: left;">Étage</th>
                                    <th style="padding: 8px; text-align: center;">H (m)</th>
                                    <th style="padding: 8px; text-align: center; width: 50px;"></th>
                                </tr>
                            </thead>
                            <tbody id="floorTableBody">
                            </tbody>
                        </table>
                        <button type="button" id="addFloorBtn" style="margin-top: 10px; background-color: #17a2b8; color: white; padding: 8px 16px; border: none; border-radius: 4px; cursor: pointer; font-size: 12px;">
                            <i class="fas fa-plus"></i> Add Floor
                        </button>
                        <button type="button" id="saveFloorsBtn" style="margin-top: 10px; margin-left: 10px; background-color: #28a745; color: white; padding: 8px 16px; border: none; border-radius: 4px; cursor: pointer; font-size: 12px;">
                            <i class="fas fa-save"></i> Save
                        </button>
                    </div>
            </div>
            <div class="right-section">
                <!-- Tab Interface - No Custom Pages for limited users -->
                <div class="tab-header">
                    <button class="tab-button active" data-tab="option-list">
                        <i class="fas fa-cogs"></i>
                        Option List
                    </button>
                    <button class="tab-button" data-tab="wall-list">
                        <i class="fas fa-th-large"></i>
                        Wall List
                    </button>
                    <button class="tab-button" data-tab="parapet-list">
                        <i class="fas fa-building"></i>
                        Parapet List
                    </button>
                    <button class="tab-button" data-tab="window-list">
                        <i class="fas fa-window-maximize"></i>
                        Window List
                    </button>
                    <button class="tab-button" data-tab="soffite-list">
                        <i class="fas fa-grip-lines-vertical"></i>
                        Soffites List
                    </button>
                </div>

                <div class="tab-content">
                    <!-- Wall List Tab Content - No report buttons -->
                    <div id="wall-list-content" class="tab-content-section">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                            <h1 style="margin: 0;">Wall List</h1>
                        </div>
                        <div class="selection-summary" id="wallSelectionSummary">
                            <i class="fas fa-th-large"></i> 0 walls added
                        </div>
                        <div id="equipmentList"></div>
                    </div>

                    <!-- Parapet List Tab Content - No report buttons -->
                    <div id="parapet-list-content" class="tab-content-section">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                            <h1 style="margin: 0;">Parapet List</h1>
                        </div>
                        <div class="selection-summary" id="parapetSelectionSummary">
                            <i class="fas fa-building"></i> 0 parapets added
                        </div>
                        <div id="parapetList" class="equipment-list">
                            <!-- Parapets will be displayed here -->
                        </div>
                    </div>

                    <!-- Options List Tab Content - No report buttons -->
                    <div id="option-list-content" class="tab-content-section active">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                            <h1 style="margin: 0;">Option List</h1>
                        </div>
                        
                        <div class="selection-summary" id="selectionSummary">
                            <i class="fas fa-check-circle"></i> 0 options selected
                        </div>

                        <!-- Category 1: Lisse TrouÃ©\ -->
                        <div class="options-category">
                            <div class="category-header">
                                <i class="fas fa-grip-lines"></i>
                                Lisse Trouee
                            </div>
                            <div id="lisse-trouee-options">
                                <!-- Options will be populated by JavaScript -->
                            </div>
                        </div>

                        <!-- Category 2: Double Lisse -->
                        <div class="options-category">
                            <div class="category-header">
                                <i class="fas fa-equals"></i>
                                Double Lisse
                            </div>
                            <div id="double-lisse-options">
                                <!-- Options will be populated by JavaScript -->
                            </div>
                        </div>

                        <!-- Category 3: Lisse Basse -->
                        <div class="options-category">
                            <div class="category-header">
                                <i class="fas fa-minus"></i>
                                Lisse Basse
                            </div>
                            <div id="lisse-basse-options">
                                <!-- Options will be populated by JavaScript -->
                            </div>
                        </div>

                        <!-- Category 4: Parapet -->
                        <div class="options-category">
                            <div class="category-header">
                                <i class="fas fa-building"></i>
                                Parapet
                            </div>
                            <div id="parapet-options">
                                <!-- Options will be populated by JavaScript -->
                            </div>
                        </div>

                        <!-- Category 5: FenÃªtre -->
                        <div class="options-category">
                            <div class="category-header">
                                <i class="fas fa-window-restore"></i>
                                Fenetre
                            </div>
                            <div id="fenetre-options">
                                <!-- Options will be populated by JavaScript -->
                            </div>
                        </div>

                        <!-- Category 6: Jambages, Linteaux & Seuils -->
                        <div class="options-category">
                            <div class="category-header">
                                <i class="fas fa-th-large"></i>
                                Jambages, Linteaux & Seuils
                            </div>
                            <div id="jambages-linteaux-seuils-options">
                                <!-- Options will be populated by JavaScript -->
                            </div>
                        </div>
                    </div>

                    <!-- Window List Tab Content - No report buttons -->
                    <div id="window-list-content" class="tab-content-section">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                            <h1 style="margin: 0;">Window List</h1>
                        </div>
                        <div class="selection-summary" id="windowSelectionSummary">
                            <i class="fas fa-window-maximize"></i> 0 windows added
                        </div>
                        <div id="windowList" class="equipment-list">
                            <!-- Windows will be displayed here -->
                        </div>
                    </div>

                    <!-- NEW: Soffites List Tab Content -->
                    <div id="soffite-list-content" class="tab-content-section">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                            <h1 style="margin: 0;">Soffites List</h1>
                        </div>
                        <div class="selection-summary" id="soffiteSelectionSummary">
                            <i class="fas fa-grip-lines-vertical"></i> 0 soffites added
                        </div>
                        <div id="soffiteList" class="equipment-list">
                            <!-- Soffites will be displayed here -->
                        </div>
                    </div>
                </div>

                <!-- Save Options button (same style as regular CFSS) -->
                <div class="save-options-btn" id="saveOptionsBtnContainer" style="display: none;">
                    <button class="save-btn" id="saveOptionsBtn">
                        <i class="fas fa-save"></i>
                        Save Options
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Bottom Half: Forms -->
        <div class="bottom-half" id="bottomHalf">
            <!-- Add Wall Button -->
            <button id="newCalculationButton" class="cfss-btn" style="display: block !important; margin: 20px 0;">
                <i class="fas fa-th-large"></i> Add Wall
            </button>

            <button id="addParapetButton" class="cfss-btn">
                <i class="fas fa-building"></i> Add Parapet
            </button>

            <button id="addWindowButton" class="cfss-btn">
                <i class="fas fa-window-maximize"></i> Add Window
            </button>

            <button id="addSoffitesButton" class="cfss-btn">
                <i class="fas fa-grip-lines-vertical"></i> Add Soffites
            </button>

            <!-- Simplified Wall Form -->
            <div id="equipmentForm" style="display: none;">
                <div class="calculation-sections">
                    <div class="equipment-form-section">
                        <div class="form-fields">
                            <h2>New Wall</h2>
                            <form id="equipmentFormElement">
                                <div class="form-group">
                                    <label for="equipment">Wall Name: <span style="color: red;">*</span></label>
                                    <input type="text" id="equipment" name="equipment" placeholder="Enter wall name..." required>
                                </div>

                                <div class="form-group">
                                    <label for="floor">Floor:</label>
                                    <input type="text" id="floor" name="floor" placeholder="e.g., 2-5">
                                </div>

                                <div class="form-group">
                                    <label for="hauteurMax">Hauteur Max:</label>
                                    <div style="display: flex; gap: 10px; align-items: center;">
                                        <input type="number" id="hauteurMax" name="hauteurMax" min="0" step="1" 
                                            style="flex: 2; padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px;">
                                        <input type="text" id="hauteurMaxMinor" name="hauteurMaxMinor" placeholder=""
                                            style="flex: 2; padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px;">
                                        <select id="hauteurMaxUnit" name="hauteurMaxUnit" 
                                            style="flex: 1; padding: 8px 8px; border: 1px solid #ddd; border-radius: 4px;">
                                            <option value="ft-in" selected>ft-in</option>
                                            <option value="mm">mm</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label>Colombage:</label>
                                    <div style="display: flex; gap: 10px; align-items: center;">
                                        <select id="colombageSet1" name="colombageSet1" 
                                            style="flex: 1; padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px;">
                                            <option value="">Set 1</option>
                                            <option value="1-5/8">1-5/8</option>
                                            <option value="2-1/2">2-1/2</option>
                                            <option value="3-5/8">3-5/8</option>
                                            <option value="6">6</option>
                                            <option value="8">8</option>
                                            <option value="10">10</option>
                                            <option value="N/A">N/A</option>
                                        </select>
                                        <select id="colombageSet2" name="colombageSet2" 
                                            style="flex: 1; padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px;">
                                            <option value="">Set 2</option>
                                            <option value="1-5/8">1-5/8</option>
                                            <option value="2-1/2">2-1/2</option>
                                            <option value="3-5/8">3-5/8</option>
                                            <option value="6">6</option>
                                            <option value="8">8</option>
                                            <option value="10">10</option>
                                            <option value="N/A">N/A</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label for="note">Note:</label>
                                    <input type="text" id="note" name="note" maxlength="100" placeholder="Optional note (max 100 characters)...">
                                </div>
                                
                                <div style="display: flex; gap: 15px; margin-top: 20px;">
                                    <button type="submit" id="saveEquipment" style="background: #28a745; color: white; border: none; padding: 12px 24px; border-radius: 5px; cursor: pointer; font-size: 14px; flex: 1;">
                                        <i class="fas fa-save"></i> Save Wall
                                    </button>
                                    <button type="button" id="cancelWall" style="background: #6c757d; color: white; border: none; padding: 12px 24px; border-radius: 5px; cursor: pointer; font-size: 14px; flex: 1;">
                                        Cancel
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Simplified Parapet Form -->
            <div id="parapetForm" style="display: none;">
                <div class="calculation-sections">
                    <div class="equipment-form-section">
                        <div class="form-fields">
                            <h2>New Parapet</h2>
                            <form id="parapetFormElement">
                                <div class="form-group">
                                    <label for="parapetName">Parapet Name: <span style="color: red;">*</span></label>
                                    <input type="text" id="parapetName" name="parapetName" placeholder="Enter parapet name..." required>
                                </div>

                                <div class="form-group">
                                    <label for="parapetType">Parapet Type:</label>
                                    <select id="parapetType" name="parapetType">
                                        <option value="">Select Parapet Type</option>
                                        <option value="Type 1">Type 1</option>
                                        <option value="Type 2">Type 2</option>
                                        <option value="Type 3">Type 3</option>
                                        <option value="Type 4">Type 4</option>
                                        <option value="Type 5">Type 5</option>
                                        <option value="Type 6">Type 6</option>
                                        <option value="Type 7">Type 7</option>
                                        <option value="Type 8">Type 8</option>
                                        <option value="Type 9">Type 9</option>
                                        <option value="Type 10">Type 10</option>
                                        <option value="Type 11">Type 11</option>
                                        <option value="Type 12">Type 12</option>
                                        <option value="Type 13">Type 13</option>
                                    </select>
                                </div>

                                <div class="form-group">
                                    <label for="parapetFloor">Floor:</label>
                                    <input type="text" id="parapetFloor" name="parapetFloor" placeholder="e.g., NV2 - NV3">
                                </div>

                                <div class="form-group">
                                    <label for="parapetHauteurMax">Hauteur Max:</label>
                                    <div style="display: flex; gap: 10px; align-items: center;">
                                        <input type="number" id="parapetHauteurMax" name="parapetHauteurMax" min="0" step="1"
                                            style="flex: 2; padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px;">
                                        <input type="text" id="parapetHauteurMaxMinor" name="parapetHauteurMaxMinor" placeholder=""
                                            style="flex: 2; padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px;">
                                        <select id="parapetHauteurMaxUnit" name="parapetHauteurMaxUnit"
                                            style="flex: 1; padding: 8px 8px; border: 1px solid #ddd; border-radius: 4px;">
                                            <option value="ft-in" selected>ft-in</option>
                                            <option value="mm">mm</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label>Colombage:</label>
                                    <div style="display: flex; gap: 10px; align-items: center;">
                                        <select id="parapetColombageSet1" name="parapetColombageSet1" 
                                            style="flex: 1; padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px;">
                                            <option value="">Set 1</option>
                                            <option value="1-5/8">1-5/8</option>
                                            <option value="2-1/2">2-1/2</option>
                                            <option value="3-5/8">3-5/8</option>
                                            <option value="6">6</option>
                                            <option value="8">8</option>
                                            <option value="10">10</option>
                                            <option value="N/A">N/A</option>
                                        </select>
                                        <select id="parapetColombageSet2" name="parapetColombageSet2" 
                                            style="flex: 1; padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px;">
                                            <option value="">Set 2</option>
                                            <option value="1-5/8">1-5/8</option>
                                            <option value="2-1/2">2-1/2</option>
                                            <option value="3-5/8">3-5/8</option>
                                            <option value="6">6</option>
                                            <option value="8">8</option>
                                            <option value="10">10</option>
                                            <option value="N/A">N/A</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label for="parapetNote">Note:</label>
                                    <input type="text" id="parapetNote" name="parapetNote" maxlength="100" placeholder="Optional note (max 100 characters)...">
                                </div>

                                <div style="display: flex; gap: 15px; margin-top: 20px;">
                                    <button type="submit" id="saveParapet" style="background: #28a745; color: white; border: none; padding: 12px 24px; border-radius: 5px; cursor: pointer; font-size: 14px; flex: 1;">
                                        <i class="fas fa-save"></i> Save Parapet
                                    </button>
                                    <button type="button" id="cancelParapet" style="background: #6c757d; color: white; border: none; padding: 12px 24px; border-radius: 5px; cursor: pointer; font-size: 14px; flex: 1;">
                                        Cancel
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Simplified Window Form -->
            <div id="windowForm" style="display: none;">
                <div class="calculation-sections">
                    <div class="equipment-form-section">
                        <div class="form-fields">
                            <h2>New Window</h2>
                            <form id="windowFormElement">
                                <div class="form-group">
                                    <label for="windowType">Window Type: <span style="color: red;">*</span></label>
                                    <input type="text" id="windowType" name="windowType" placeholder="Enter window type..." required>
                                </div>

                                <div class="form-group">
                                    <label for="windowFloor">Floor:</label>
                                    <input type="text" id="windowFloor" name="windowFloor" placeholder="e.g., 2-5">
                                </div>
                                
                                <div class="form-group">
                                    <label for="windowLargeurMax">Largeur Max:</label>
                                    <div style="display: flex; gap: 10px; align-items: center;">
                                        <input type="number" id="windowLargeurMax" name="windowLargeurMax" min="0" step="1"
                                            style="flex: 2; padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px;">
                                        <input type="text" id="windowLargeurMaxMinor" name="windowLargeurMaxMinor" placeholder=""
                                            style="flex: 2; padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px;">
                                        <select id="windowLargeurMaxUnit" name="windowLargeurMaxUnit"
                                            style="flex: 1; padding: 8px 8px; border: 1px solid #ddd; border-radius: 4px;">
                                            <option value="ft-in" selected>ft-in</option>
                                            <option value="mm">mm</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label for="windowHauteurMax">Hauteur Max:</label>
                                    <div style="display: flex; gap: 10px; align-items: center;">
                                        <input type="number" id="windowHauteurMax" name="windowHauteurMax" min="0" step="1"
                                            style="flex: 2; padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px;">
                                        <input type="text" id="windowHauteurMaxMinor" name="windowHauteurMaxMinor" placeholder=""
                                            style="flex: 2; padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px;">
                                        <select id="windowHauteurMaxUnit" name="windowHauteurMaxUnit"
                                            style="flex: 1; padding: 8px 8px; border: 1px solid #ddd; border-radius: 4px;">
                                            <option value="ft-in" selected>ft-in</option>
                                            <option value="mm">mm</option>
                                        </select>
                                    </div>
                                </div>

                                <div style="display: flex; gap: 15px; margin-top: 20px;">
                                    <button type="submit" id="saveWindow" style="background: #28a745; color: white; border: none; padding: 12px 24px; border-radius: 5px; cursor: pointer; font-size: 14px; flex: 1;">
                                        <i class="fas fa-save"></i> Save Window
                                    </button>
                                    <button type="button" id="cancelWindow" style="background: #6c757d; color: white; border: none; padding: 12px 24px; border-radius: 5px; cursor: pointer; font-size: 14px; flex: 1;">
                                        Cancel
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Simplified Soffite Form -->
            <div id="soffiteForm" style="display: none;">
                <div class="calculation-sections">
                    <div class="equipment-form-section">
                        <div class="form-fields">
                            <h2>New Soffite</h2>
                            <form id="soffiteFormElement">
                                <!-- Soffite name -->
                                <div class="form-group">
                                    <label for="soffiteName">Soffite name: <span style="color: red;">*</span></label>
                                    <input
                                        type="text"
                                        id="soffiteName"
                                        name="soffiteName"
                                        placeholder="Enter soffite name..."
                                        required>
                                </div>

                                                                <!-- Soffite images: image area stacked under label -->
                                <div class="form-group">
                                    <label>Soffite images:</label>
                                    <small style="display:block; font-size:12px; color:#666;">
                                        Max 2 images. Drag &amp; drop, browse, or paste (Ctrl+V).
                                    </small>

                                    <!-- Stacked image upload section, sized like CFSS wall/parapet -->
                                    <div class="image-upload-section soffite-image-upload" style="max-width: 200px;">
                                        <div class="upload-controls">
                                            <button
                                                type="button"
                                                class="camera-btn"
                                                id="soffiteCameraBtn"
                                                title="Upload Image">
                                                <i class="fas fa-camera"></i>
                                                Browse
                                            </button>
                                        </div>

                                        <input
                                            class="drop-zone"
                                            id="soffiteDropZone"
                                            placeholder="Drop or paste image here (Ctrl+V)"
                                            readonly
                                            tabindex="0">

                                        <div class="image-preview-container" id="soffiteImagePreviewContainer"></div>

                                        <input
                                            type="file"
                                            id="soffiteImageFileInput"
                                            accept="image/*"
                                            style="display: none;"
                                            multiple>
                                    </div>
                                </div>


                                <!-- Save / cancel buttons -->
                                <div style="display: flex; gap: 15px; margin-top: 20px;">
                                    <button
                                        type="submit"
                                        id="saveSoffite"
                                        style="background: #28a745; color: white; border: none; padding: 10px 15px; border-radius: 5px; cursor: pointer; font-size: 14px; flex: 1;">
                                        <i class="fas fa-save"></i> Save Soffite
                                    </button>
                                    <button
                                        type="button"
                                        id="cancelSoffite"
                                        style="background: #6c757d; color: white; border: none; padding: 10px 15px; border-radius: 5px; cursor: pointer; font-size: 14px; flex: 1;">
                                        Cancel
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- AWS Cognito SDK -->
    <script src="https://cdn.jsdelivr.net/npm/aws-sdk@2.1692.0/dist/aws-sdk.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/amazon-cognito-identity-js@6.3.15/dist/amazon-cognito-identity.min.js"></script>
    <script src="auth-helper.js"></script>
    <script src="limited-cfss-project-details.js"></script>
</body>
</html>
