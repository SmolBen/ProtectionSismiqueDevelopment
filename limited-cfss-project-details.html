<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CFSS Project Details</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="project-details.css">
    <link rel="stylesheet" href="cfss-project-details.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">

<style>
    .image-upload-section {
        margin-top: 15px;
        padding: 15px;
        border: 1px solid #e0e0e0;
        border-radius: 8px;
        background: #fafafa;
    }
    .upload-controls {
        display: flex;
        flex-direction: column;
        gap: 10px;
    }
    .camera-btn {
        background: #17a2b8 !important;
        color: white !important;
        border: none !important;
        padding: 12px 24px !important;
        border-radius: 4px !important;
        cursor: pointer !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        gap: 8px !important;
        font-size: 14px !important;
        width: 100% !important;
    }
    .camera-btn:hover {
        background: #138496 !important;
    }
    .drop-zone {
        width: 100% !important;
        padding: 20px !important;
        border: 2px dashed #ccc !important;
        border-radius: 4px !important;
        background: white !important;
        text-align: center !important;
        color: #666 !important;
        font-size: 13px !important;
        min-height: 60px !important;
        box-sizing: border-box !important;
    }
    .drop-zone.dragover {
        border-color: #17a2b8 !important;
        background: #f0f9ff !important;
    }
    .image-preview-container {
        display: flex;
        gap: 10px;
        margin-top: 10px;
        flex-wrap: wrap;
    }
    .image-preview {
        position: relative;
        width: 80px;
        height: 80px;
        border: 1px solid #ddd;
        border-radius: 4px;
        overflow: hidden;
    }
    .image-preview img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }
    .image-remove {
        position: absolute;
        top: 2px;
        right: 2px;
        background: #e74c3c;
        color: white;
        border: none;
        border-radius: 50%;
        width: 20px;
        height: 20px;
        cursor: pointer;
        font-size: 12px;
        line-height: 1;
    }
</style>

</head>
<body class="limited-cfss-page">
    <nav class="navbar">
        <div class="navbar-content">
            <div class="title-area">
                <a href="https://www.protectionsismique2000.com/" class="title">Protection Sismique - CFSS</a>
                <a href="limited-cfss-dashboard.html" class="dashboard-btn">
                    <i class="fas fa-th-large"></i>
                    Dashboard
                </a>
            </div>
            <div class="user-info" id="userInfo">
                <!-- User info will be populated by JavaScript -->
            </div>
        </div>
    </nav>
    
    <div class="loading-project" id="loadingProject">
        <h2>Loading CFSS Project...</h2>
        <p>Please wait while we load the project details.</p>
    </div>
    
    <div class="auth-error" id="authError" style="display: none;">
        <h2>Authentication Required</h2>
        <p>Please log in to view CFSS project details.</p>
        <button onclick="window.location.href='auth.html'">Go to Login</button>
    </div>
    
    <div class="access-denied" id="accessDenied" style="display: none;">
        <h2>Access Denied</h2>
        <p>You don't have permission to view this CFSS project.</p>
        <button onclick="window.location.href='limited-cfss-dashboard.html'">Back to Dashboard</button>
    </div>
    
    <div class="container" id="projectContainer" style="display: none;">
        <!-- Top Half split into two horizontal sections -->
        <div class="top-half">
            <div class="left-section">
                <h1>CFSS Project Details</h1>
                
                <!-- Basic Information (Always Visible) -->
                <div class="basic-info">
                    <p><strong>Project Name:</strong> <span id="projectName"></span></p>
                        <p><strong>Company Name:</strong> <span id="companyName"></span></p>
                        <p><strong>Client Name:</strong> <span id="clientName"></span></p>
                        <p><strong>Description:</strong> <span id="projectDescription"></span></p>
                        <p><strong>Address:</strong> <span id="projectAddress"></span></p>
                        <p><strong>Deflection Max:</strong> <span id="projectDeflectionMax"></span></p>
                        <p><strong>Thickness Min:</strong> <span id="projectThicknessMin"></span></p>
                        <p><strong>Status:</strong> 
                            <select id="projectStatusDropdown">
                                <option value="Planning">Planning</option>
                                <option value="In Progress">In Progress</option>
                                <option value="Completed">Completed</option>
                            </select>
                        </p>
                </div>
                
                <!-- Floor Table -->
                    <div class="floor-section" style="margin-top: 20px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; border-bottom: 1px solid #17a2b8; padding-bottom: 5px;">
                            <h4 style="margin: 0; color: #17a2b8; font-size: 14px;">Calculs par étage</h4>
                        </div>
                        <table style="width: 100%; border-collapse: collapse; font-size: 12px;">
                            <thead>
                                <tr style="background: #17a2b8; color: white;">
                                    <th style="padding: 8px; text-align: left;">Étage</th>
                                    <th style="padding: 8px; text-align: center;">H (m)</th>
                                    <th style="padding: 8px; text-align: center; width: 50px;"></th>
                                </tr>
                            </thead>
                            <tbody id="floorTableBody">
                            </tbody>
                        </table>
                        <button type="button" id="addFloorBtn" style="margin-top: 10px; background-color: #17a2b8; color: white; padding: 8px 16px; border: none; border-radius: 4px; cursor: pointer; font-size: 12px;">
                            <i class="fas fa-plus"></i> Add Floor
                        </button>
                        <button type="button" id="saveFloorsBtn" style="margin-top: 10px; margin-left: 10px; background-color: #28a745; color: white; padding: 8px 16px; border: none; border-radius: 4px; cursor: pointer; font-size: 12px;">
                            <i class="fas fa-save"></i> Save
                        </button>
                    </div>

                    <!-- Project Files Section -->
                <div class="files-section" style="margin-top: 20px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; border-bottom: 2px solid #17a2b8; padding-bottom: 5px;">
                        <h4 style="margin: 0; color: #17a2b8; font-size: 14px;">Project Files</h4>
                        <button id="showUploadFileBtn" style="background: #17a2b8; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; font-size: 13px; display: flex; align-items: center; gap: 6px;">
                            <i class="fas fa-plus"></i>
                            Upload File
                        </button>
                    </div>

                    <div id="uploadFileRow" style="display: none; background: #e8f5f7; padding: 15px; border-radius: 5px; margin-bottom: 15px; border: 2px dashed #17a2b8;">
                        <!-- Toggle Pills -->
                        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 12px;">
                            <span style="font-size: 12px; font-weight: 500; color: #333;">Source:</span>
                            <div style="display: inline-flex; background: #d4d4d4; border-radius: 6px; padding: 3px;">
                                <button type="button" id="uploadModeFile" class="upload-mode-btn active" style="padding: 6px 14px; font-size: 12px; border: none; border-radius: 4px; cursor: pointer; background: #17a2b8; color: white; transition: all 0.2s;">
                                    Upload File
                                </button>
                                <button type="button" id="uploadModeLink" class="upload-mode-btn" style="padding: 6px 14px; font-size: 12px; border: none; border-radius: 4px; cursor: pointer; background: transparent; color: #555; transition: all 0.2s;">
                                    Paste Link
                                </button>
                            </div>
                        </div>
                        <!-- Input Row -->
                        <div style="display: flex; gap: 15px; align-items: flex-end;">
                            <div style="flex: 2;">
                                <label style="display: block; font-size: 12px; font-weight: 500; margin-bottom: 5px; color: #333;">
                                    File Name <span style="color: red;">*</span>
                                </label>
                                <input type="text" id="uploadFileName" placeholder="Enter file name..." style="width: 100%; padding: 8px 10px; border: 1px solid #ddd; border-radius: 3px; font-size: 13px; height: 34px; box-sizing: border-box;">
                            </div>
                            <div style="flex: 3;">
                                <label id="uploadInputLabel" style="display: block; font-size: 12px; font-weight: 500; margin-bottom: 5px; color: #333;">
                                    Select File <span style="color: red;">*</span>
                                </label>
                                <!-- File Input (shown by default) -->
                                <input type="file" id="uploadFileInput" accept="image/*,.pdf" style="width: 100%; padding: 6px 10px; border: 1px solid #ddd; border-radius: 3px; font-size: 13px; background: white; height: 34px; box-sizing: border-box;">
                                <!-- Link Input (hidden by default) -->
                                <input type="text" id="uploadLinkInput" placeholder="https://example.com/file.pdf" style="display: none; width: 100%; padding: 8px 10px; border: 1px solid #ddd; border-radius: 3px; font-size: 13px; height: 34px; box-sizing: border-box;">
                            </div>
                            <div style="display: flex; gap: 8px; flex-shrink: 0;">
                                <button id="uploadFileSubmitBtn" style="background: #28a745; color: white; border: none; padding: 8px 14px; border-radius: 3px; cursor: pointer; font-size: 12px; white-space: nowrap; height: 34px; min-width: 80px;">
                                    <i class="fas fa-upload"></i> Upload
                                </button>
                                <button id="uploadFileCancelBtn" style="background: #6c757d; color: white; border: none; padding: 8px 14px; border-radius: 3px; cursor: pointer; font-size: 12px; height: 34px;">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                    <table style="width: 100%; border-collapse: collapse; font-size: 13px;" id="filesTable">
                        <thead>
                            <tr style="background: #f8f9fa; border-bottom: 2px solid #e0e0e0;">
                                <th style="text-align: left; padding: 10px; font-weight: 600; color: #333; font-size: 12px; text-transform: uppercase; width: 50%;">File Name</th>
                                <th style="text-align: left; padding: 10px; font-weight: 600; color: #333; font-size: 12px; text-transform: uppercase; width: 20%;">Type</th>
                                <th style="text-align: left; padding: 10px; font-weight: 600; color: #333; font-size: 12px; text-transform: uppercase; width: 20%;">Date</th>
                                <th style="text-align: center; padding: 10px; font-weight: 600; color: #333; font-size: 12px; text-transform: uppercase; width: 10%;">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="filesTableBody">
                            <!-- Files will be populated here -->
                        </tbody>
                    </table>

                    <div id="filesEmptyState" style="display: none; text-align: center; padding: 50px; color: #999;">
                        <i class="fas fa-folder-open" style="font-size: 48px; opacity: 0.3; margin-bottom: 15px;"></i>
                        <p style="margin: 0;">No files uploaded yet. Click "Upload File" to add files.</p>
                    </div>
                </div>

<!-- Submit to Admin Section -->
<div class="submit-admin-section" style="
    margin-top: 25px;
    padding: 16px;
    background: #ffffff;
    border: 1px solid #e6e9ef;
    border-radius: 8px;
">
    <div style="display: flex; justify-content: space-between; align-items: center; gap: 12px;">
        <div style="
            flex: 1;
            padding-left: 12px;
            border-left: 4px solid #0d6efd;
        ">
            <h4 style="margin: 0 0 6px 0; font-size: 15px; font-weight: 700; color: #111827;">
                <i class="fas fa-paper-plane" style="margin-right: 8px; color: #0d6efd;"></i>
                Submit Project to Admin
            </h4>
            <p id="submitStatusText" style="margin: 0; font-size: 13px; color: #6b7280;">
                Send this project for admin review and processing.
            </p>
        </div>

        <button id="submitToAdminBtn" onclick="submitToAdmin()" style="
            background: #0d6efd;
            color: #ffffff;
            border: 1px solid #0d6efd;
            padding: 10px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: background 0.2s, border-color 0.2s;
            white-space: nowrap;
        ">
            <i class="fas fa-paper-plane"></i>
            <span id="submitBtnText">Submit</span>
        </button>
    </div>

    <div id="submittedInfo" style="
        display: none;
        margin-top: 10px;
        padding-top: 10px;
        border-top: 1px solid #eef1f6;
    ">
        <p style="margin: 0; color: #111827; font-size: 12px;">
            <i class="fas fa-check-circle" style="margin-right: 6px; color: #16a34a;"></i>
            <span id="submittedDate"></span>
        </p>
    </div>
</div>

            </div>
            <div class="right-section">
                <!-- Tab Interface - No Custom Pages for limited users -->
                <div class="tab-header">
                    <button class="tab-button active" data-tab="option-list">
                        <i class="fas fa-cogs"></i>
                        Option List
                    </button>
                    <button class="tab-button" data-tab="wall-list">
                        <i class="fas fa-th-large"></i>
                        Wall List
                    </button>
                    <button class="tab-button" data-tab="parapet-list">
                        <i class="fas fa-building"></i>
                        Parapet List
                    </button>
                    <button class="tab-button" data-tab="window-list">
                        <i class="fas fa-window-maximize"></i>
                        Window List
                    </button>
                    <button class="tab-button" data-tab="soffite-list">
                        <i class="fas fa-grip-lines-vertical"></i>
                        Soffites List
                    </button>
                </div>

                <div class="tab-content">
                    <!-- Wall List Tab Content - No report buttons -->
                    <div id="wall-list-content" class="tab-content-section">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                            <h1 style="margin: 0;">Wall List</h1>
                        </div>
                        <div class="selection-summary" id="wallSelectionSummary">
                            <i class="fas fa-th-large"></i> 0 walls added
                        </div>
                        <div id="equipmentList"></div>
                    </div>

                    <!-- Parapet List Tab Content - No report buttons -->
                    <div id="parapet-list-content" class="tab-content-section">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                            <h1 style="margin: 0;">Parapet List</h1>
                        </div>
                        <div class="selection-summary" id="parapetSelectionSummary">
                            <i class="fas fa-building"></i> 0 parapets added
                        </div>
                        <div id="parapetList" class="equipment-list">
                            <!-- Parapets will be displayed here -->
                        </div>
                    </div>

                    <!-- Options List Tab Content - No report buttons -->
                    <div id="option-list-content" class="tab-content-section active">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                            <h1 style="margin: 0;">Option List</h1>
                        </div>
                        
                        <div class="selection-summary" id="selectionSummary">
                            <i class="fas fa-check-circle"></i> 0 options selected
                        </div>

                        <!-- Category 1: Lisse TrouÃƒÂ©\ -->
                        <div class="options-category">
                            <div class="category-header">
                                <i class="fas fa-grip-lines"></i>
                                Lisse Trouee
                            </div>
                            <div id="lisse-trouee-options">
                                <!-- Options will be populated by JavaScript -->
                            </div>
                        </div>

                        <!-- Category 2: Double Lisse -->
                        <div class="options-category">
                            <div class="category-header">
                                <i class="fas fa-equals"></i>
                                Double Lisse
                            </div>
                            <div id="double-lisse-options">
                                <!-- Options will be populated by JavaScript -->
                            </div>
                        </div>

                        <!-- Category 3: Lisse Basse -->
                        <div class="options-category">
                            <div class="category-header">
                                <i class="fas fa-minus"></i>
                                Lisse Basse
                            </div>
                            <div id="lisse-basse-options">
                                <!-- Options will be populated by JavaScript -->
                            </div>
                        </div>

                        <!-- Category 4: Parapet -->
                        <div class="options-category">
                            <div class="category-header">
                                <i class="fas fa-building"></i>
                                Parapet
                            </div>
                            <div id="parapet-options">
                                <!-- Options will be populated by JavaScript -->
                            </div>
                        </div>

                        <!-- Category 5: FenÃƒÂªtre -->
                        <div class="options-category">
                            <div class="category-header">
                                <i class="fas fa-window-restore"></i>
                                Fenetre
                            </div>
                            <div id="fenetre-options">
                                <!-- Options will be populated by JavaScript -->
                            </div>
                        </div>

                        <!-- Category 6: Jambages, Linteaux & Seuils -->
                        <div class="options-category">
                            <div class="category-header">
                                <i class="fas fa-th-large"></i>
                                Jambages, Linteaux & Seuils
                            </div>
                            <div id="jambages-linteaux-seuils-options">
                                <!-- Options will be populated by JavaScript -->
                            </div>
                        </div>
                    </div>

                    <!-- Window List Tab Content - No report buttons -->
                    <div id="window-list-content" class="tab-content-section">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                            <h1 style="margin: 0;">Window List</h1>
                        </div>
                        <div class="selection-summary" id="windowSelectionSummary">
                            <i class="fas fa-window-maximize"></i> 0 windows added
                        </div>
                        <div id="windowList" class="equipment-list">
                            <!-- Windows will be displayed here -->
                        </div>
                    </div>

                    <!-- NEW: Soffites List Tab Content -->
                    <div id="soffite-list-content" class="tab-content-section">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                            <h1 style="margin: 0;">Soffites List</h1>
                        </div>
                        <div class="selection-summary" id="soffiteSelectionSummary">
                            <i class="fas fa-grip-lines-vertical"></i> 0 soffites added
                        </div>
                        <div id="soffiteList" class="equipment-list">
                            <!-- Soffites will be displayed here -->
                        </div>
                    </div>
                </div>

                <!-- Save Options button (same style as regular CFSS) -->
                <div class="save-options-btn" id="saveOptionsBtnContainer" style="display: none;">
                    <button class="save-btn" id="saveOptionsBtn">
                        <i class="fas fa-save"></i>
                        Save Options
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Bottom Half: Forms -->
        <div class="bottom-half" id="bottomHalf">
            <!-- Add Wall Button -->
            <button id="newCalculationButton" class="cfss-btn" style="display: block !important; margin: 20px 0;">
                <i class="fas fa-th-large"></i> Add Wall
            </button>

            <button id="addParapetButton" class="cfss-btn">
                <i class="fas fa-building"></i> Add Parapet
            </button>

            <button id="addWindowButton" class="cfss-btn">
                <i class="fas fa-window-maximize"></i> Add Window
            </button>

            <button id="addSoffitesButton" class="cfss-btn">
                <i class="fas fa-grip-lines-vertical"></i> Add Soffites
            </button>

            <!-- Simplified Wall Form -->
            <div id="equipmentForm" style="display: none;">
                <div class="calculation-sections">
                    <div class="equipment-form-section">
                        <div class="form-fields">
                            <h2>New Wall</h2>
                            <form id="equipmentFormElement">
                                <div class="form-group">
                                    <label for="equipment">Wall Name: <span style="color: red;">*</span></label>
                                    <input type="text" id="equipment" name="equipment" placeholder="Enter wall name..." required>
                                </div>

                                <div class="form-group">
                                    <label for="floor">Floor:</label>
                                    <input type="text" id="floor" name="floor" placeholder="e.g., 2-5">
                                </div>

                                <div class="form-group">
                                    <label for="hauteurMax">Hauteur Max:</label>
                                    <div style="display: flex; gap: 10px; align-items: center;">
                                        <input type="number" id="hauteurMax" name="hauteurMax" min="0" step="1" 
                                            style="flex: 2; padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px;">
                                        <input type="text" id="hauteurMaxMinor" name="hauteurMaxMinor" placeholder=""
                                            style="flex: 2; padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px;">
                                        <select id="hauteurMaxUnit" name="hauteurMaxUnit" 
                                            style="flex: 1; padding: 8px 8px; border: 1px solid #ddd; border-radius: 4px;">
                                            <option value="ft-in" selected>ft-in</option>
                                            <option value="mm">mm</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label>Colombage:</label>
                                    <div style="display: flex; gap: 10px; align-items: center;">
                                        <select id="colombageSet1" name="colombageSet1" 
                                            style="flex: 1; padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px;">
                                            <option value="">Set 1</option>
                                            <option value="1-5/8">1-5/8</option>
                                            <option value="2-1/2">2-1/2</option>
                                            <option value="3-5/8">3-5/8</option>
                                            <option value="6">6</option>
                                            <option value="8">8</option>
                                            <option value="10">10</option>
                                            <option value="N/A">N/A</option>
                                        </select>
                                        <select id="colombageSet2" name="colombageSet2" 
                                            style="flex: 1; padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px;">
                                            <option value="">Set 2</option>
                                            <option value="1-5/8">1-5/8</option>
                                            <option value="2-1/2">2-1/2</option>
                                            <option value="3-5/8">3-5/8</option>
                                            <option value="6">6</option>
                                            <option value="8">8</option>
                                            <option value="10">10</option>
                                            <option value="N/A">N/A</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label>Déflexion Max:</label>
                                    <div style="display: flex; gap: 10px; align-items: center;">
                                        <select id="deflexionSet1" name="deflexionSet1" 
                                            style="flex: 1; padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px;">
                                            <option value="">Select déflexion max...</option>
                                            <option value="L/180">L/180</option>
                                            <option value="L/240">L/240</option>
                                            <option value="L/360">L/360</option>
                                            <option value="L/480">L/480</option>
                                            <option value="L/600">L/600</option>
                                            <option value="L/720">L/720</option>
                                            <option value="N/A">N/A</option>
                                        </select>
                                        <select id="deflexionSet2" name="deflexionSet2" 
                                            style="flex: 1; padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px;">
                                            <option value="">Select déflexion max...</option>
                                            <option value="L/180">L/180</option>
                                            <option value="L/240">L/240</option>
                                            <option value="L/360">L/360</option>
                                            <option value="L/480">L/480</option>
                                            <option value="L/600">L/600</option>
                                            <option value="L/720">L/720</option>
                                            <option value="N/A">N/A</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label for="note">Note:</label>
                                    <input type="text" id="note" name="note" maxlength="100" placeholder="Optional note (max 100 characters)...">
                                </div>
                                
                                <div style="display: flex; gap: 15px; margin-top: 20px;">
                                    <button type="submit" id="saveEquipment" style="background: #28a745; color: white; border: none; padding: 12px 24px; border-radius: 5px; cursor: pointer; font-size: 14px; flex: 1;">
                                        <i class="fas fa-save"></i> Save Wall
                                    </button>
                                    <button type="button" id="cancelWall" style="background: #6c757d; color: white; border: none; padding: 12px 24px; border-radius: 5px; cursor: pointer; font-size: 14px; flex: 1;">
                                        Cancel
                                    </button>
                                </div>
                            </form>
                        </div>
                        
                        <!-- Image Upload Section -->
                        <div class="image-upload-section">
                            <div class="upload-controls">
                                <button type="button" class="camera-btn" id="cameraBtn" title="Upload Images">
                                    <i class="fas fa-camera"></i>
                                    Browse
                                </button>
                                
                                <input 
                                    class="drop-zone" 
                                    id="dropZone" 
                                    placeholder="Drop or paste images here (Ctrl+V)"
                                    readonly
                                    tabindex="0">
                            </div>
                            
                            <div class="image-preview-container" id="imagePreviewContainer"></div>
                        </div>
                        <input type="file" id="imageFileInput" multiple accept="image/*" style="display: none;">
                    </div>
                </div>
                </div>
            </div>

            <!-- Simplified Parapet Form -->
            <div id="parapetForm" style="display: none;">
                <div class="calculation-sections">
                    <div class="equipment-form-section">
                        <div class="form-fields">
                            <h2>New Parapet</h2>
                            <form id="parapetFormElement">
                                <div class="form-group">
                                    <label for="parapetName">Parapet Name: <span style="color: red;">*</span></label>
                                    <input type="text" id="parapetName" name="parapetName" placeholder="Enter parapet name..." required>
                                </div>

                                <div class="form-group">
                                    <label for="parapetType">Parapet Type:</label>
                                    <div style="display: flex; gap: 10px; align-items: flex-start;">
                                        <select id="parapetType" name="parapetType" style="flex: 1; max-width: 190px;">
                                            <option value="">Select Parapet Type</option>
                                        </select>
                                        
                                        <div id="parapetTypeImagePreview" style="
                                            width: 105px;
                                            height: 105px;
                                            border: 1px solid #ddd;
                                            border-radius: 4px;
                                            background: #f9f9f9;
                                            display: flex;
                                            flex-direction: column;
                                            align-items: center;
                                            justify-content: center;
                                        ">
                                            <span style="color: #999; font-size: 13px; text-align: center;">Select a type</span>
                                        </div>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label for="parapetFloor">Floor:</label>
                                    <input type="text" id="parapetFloor" name="parapetFloor" placeholder="e.g., NV2 - NV3">
                                </div>

                                <div class="form-group">
                                    <label for="parapetHauteurMax">Hauteur Max:</label>
                                    <div style="display: flex; gap: 10px; align-items: center;">
                                        <input type="number" id="parapetHauteurMax" name="parapetHauteurMax" min="0" step="1"
                                            style="flex: 2; padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px;">
                                        <input type="text" id="parapetHauteurMaxMinor" name="parapetHauteurMaxMinor" placeholder=""
                                            style="flex: 2; padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px;">
                                        <select id="parapetHauteurMaxUnit" name="parapetHauteurMaxUnit"
                                            style="flex: 1; padding: 8px 8px; border: 1px solid #ddd; border-radius: 4px;">
                                            <option value="ft-in" selected>ft-in</option>
                                            <option value="mm">mm</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label>Colombage:</label>
                                    <div style="display: flex; gap: 10px; align-items: center;">
                                        <select id="parapetColombageSet1" name="parapetColombageSet1" 
                                            style="flex: 1; padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px;">
                                            <option value="">Set 1</option>
                                            <option value="1-5/8">1-5/8</option>
                                            <option value="2-1/2">2-1/2</option>
                                            <option value="3-5/8">3-5/8</option>
                                            <option value="6">6</option>
                                            <option value="8">8</option>
                                            <option value="10">10</option>
                                            <option value="N/A">N/A</option>
                                        </select>
                                        <select id="parapetColombageSet2" name="parapetColombageSet2" 
                                            style="flex: 1; padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px;">
                                            <option value="">Set 2</option>
                                            <option value="1-5/8">1-5/8</option>
                                            <option value="2-1/2">2-1/2</option>
                                            <option value="3-5/8">3-5/8</option>
                                            <option value="6">6</option>
                                            <option value="8">8</option>
                                            <option value="10">10</option>
                                            <option value="N/A">N/A</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label for="parapetNote">Note:</label>
                                    <input type="text" id="parapetNote" name="parapetNote" maxlength="100" placeholder="Optional note (max 100 characters)...">
                                </div>

                                <div style="display: flex; gap: 15px; margin-top: 20px;">
                                    <button type="submit" id="saveParapet" style="background: #28a745; color: white; border: none; padding: 12px 24px; border-radius: 5px; cursor: pointer; font-size: 14px; flex: 1;">
                                        <i class="fas fa-save"></i> Save Parapet
                                    </button>
                                    <button type="button" id="cancelParapet" style="background: #6c757d; color: white; border: none; padding: 12px 24px; border-radius: 5px; cursor: pointer; font-size: 14px; flex: 1;">
                                        Cancel
                                    </button>
                                </div>
                            </form>
                        </div>
                        
                        <!-- Image Upload Section -->
                        <div class="image-upload-section">
                            <div class="upload-controls">
                                <button type="button" class="camera-btn" id="parapetCameraBtn" title="Upload Images">
                                    <i class="fas fa-camera"></i>
                                    Browse
                                </button>
                                
                                <input 
                                    class="drop-zone" 
                                    id="parapetDropZone" 
                                    placeholder="Drop or paste images here (Ctrl+V)"
                                    readonly
                                    tabindex="0">
                            </div>
                            
                            <div class="image-preview-container" id="parapetImagePreviewContainer"></div>
                        </div>
                        <input type="file" id="parapetImageFileInput" multiple accept="image/*" style="display: none;">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Simplified Window Form -->
            <div id="windowForm" style="display: none;">
                <div class="calculation-sections">
                    <div class="equipment-form-section">
                        <div style="display: grid; grid-template-columns: 1fr auto; gap: 30px;">
                            <!-- Left side: Form -->
                            <div class="form-fields">
                                <h2>New Window</h2>
                                <form id="windowFormElement">
                                    <div style="display: flex; gap: 15px;">
                                    <div class="form-group" style="flex: 1;">
                                        <label for="windowType">Window Type: <span style="color: red;">*</span></label>
                                        <input type="text" id="windowType" name="windowType" placeholder="Enter window type..." required>
                                    </div>
                                    <div class="form-group" style="flex: 1;">
                                        <label for="windowColombageSize">Colombage:</label>
                                        <select id="windowColombageSize" name="windowColombageSize" 
                                            style="width: 100%; padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px;">
                                            <option value="">Select colombage...</option>
                                            <option value="3-5/8">3-5/8</option>
                                            <option value="6">6"</option>
                                            <option value="8">8"</option>
                                            <option value="10">10"</option>
                                            <option value="N/A">N/A</option>
                                        </select>
                                    </div>
                                </div>

                                    <div class="form-group">
                                        <label for="windowFloor">Floor:</label>
                                        <input type="text" id="windowFloor" name="windowFloor" placeholder="e.g., 2-5">
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="windowLargeurMax">Largeur Max:</label>
                                        <div style="display: flex; gap: 10px; align-items: center;">
                                            <input type="number" id="windowLargeurMax" name="windowLargeurMax" min="0" step="1"
                                                style="flex: 2; padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px;">
                                            <input type="text" id="windowLargeurMaxMinor" name="windowLargeurMaxMinor" placeholder=""
                                                style="flex: 2; padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px;">
                                            <select id="windowLargeurMaxUnit" name="windowLargeurMaxUnit"
                                                style="flex: 1; padding: 8px 8px; border: 1px solid #ddd; border-radius: 4px;">
                                                <option value="ft-in" selected>ft-in</option>
                                                <option value="mm">mm</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label for="windowHauteurMax">Hauteur Max:</label>
                                        <div style="display: flex; gap: 10px; align-items: center;">
                                            <input type="number" id="windowHauteurMax" name="windowHauteurMax" min="0" step="1"
                                                style="flex: 2; padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px;">
                                            <input type="text" id="windowHauteurMaxMinor" name="windowHauteurMaxMinor" placeholder=""
                                                style="flex: 2; padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px;">
                                            <select id="windowHauteurMaxUnit" name="windowHauteurMaxUnit"
                                                style="flex: 1; padding: 8px 8px; border: 1px solid #ddd; border-radius: 4px;">
                                                <option value="ft-in" selected>ft-in</option>
                                                <option value="mm">mm</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label for="windowL1">L1:</label>
                                        <div style="display: flex; gap: 10px; align-items: center;">
                                            <input type="number" id="windowL1" name="windowL1" min="0" step="1"
                                                style="flex: 2; padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px;">
                                            <input type="text" id="windowL1Minor" name="windowL1Minor" placeholder=""
                                                style="flex: 2; padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px;">
                                            <select id="windowL1Unit" name="windowL1Unit"
                                                onchange="toggleMinorField('windowL1')"
                                                style="flex: 1; padding: 8px 8px; border: 1px solid #ddd; border-radius: 4px;">
                                                <option value="ft-in" selected>ft-in</option>
                                                <option value="mm">mm</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label for="windowL2">L2:</label>
                                        <div style="display: flex; gap: 10px; align-items: center;">
                                            <input type="number" id="windowL2" name="windowL2" min="0" step="1"
                                                style="flex: 2; padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px;">
                                            <input type="text" id="windowL2Minor" name="windowL2Minor" placeholder=""
                                                style="flex: 2; padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px;">
                                            <select id="windowL2Unit" name="windowL2Unit"
                                                onchange="toggleMinorField('windowL2')"
                                                style="flex: 1; padding: 8px 8px; border: 1px solid #ddd; border-radius: 4px;">
                                                <option value="ft-in" selected>ft-in</option>
                                                <option value="mm">mm</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div style="display: flex; gap: 15px; margin-top: 20px;">
                                        <button type="submit" id="saveWindow" style="background: #28a745; color: white; border: none; padding: 12px 24px; border-radius: 5px; cursor: pointer; font-size: 14px; flex: 1;">
                                            <i class="fas fa-save"></i> Save Window
                                        </button>
                                        <button type="button" id="cancelWindow" style="background: #6c757d; color: white; border: none; padding: 12px 24px; border-radius: 5px; cursor: pointer; font-size: 14px; flex: 1;">
                                            Cancel
                                        </button>
                                    </div>
                                </form>
                            </div>
                            
                            <!-- Right side: Window Image -->
                            <div style="display: flex; align-items: stretch; justify-content: center;">
                                <div style="
                                    width: 500px;
                                    padding: 20px;
                                    border: 1px solid #ddd;
                                    border-radius: 8px;
                                    background: #f9f9f9;
                                    display: flex;
                                    flex-direction: column;
                                    align-items: center;
                                    justify-content: center;
                                ">
                                    <img 
                                        src="https://protection-sismique-equipment-images.s3.us-east-1.amazonaws.com/window-form-images/window-form-image.png"
                                        alt="Window Reference"
                                        style="
                                            width: 100%;
                                            height: 100%;
                                            object-fit: contain;
                                            border-radius: 4px;
                                            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
                                        "
                                        onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                                    <span style="display: none; color: #999; font-size: 13px; text-align: center; padding: 20px;">Image not available</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Simplified Soffite Form -->
            <div id="soffiteForm" style="display: none;">
                <div class="calculation-sections">
                    <div class="equipment-form-section">
                        <div class="form-fields">
                            <h2>New Soffite</h2>
                            <form id="soffiteFormElement">
                                <!-- Soffite name -->
                                <div class="form-group">
                                    <label for="soffiteName">Soffite name: <span style="color: red;">*</span></label>
                                    <input
                                        type="text"
                                        id="soffiteName"
                                        name="soffiteName"
                                        placeholder="Enter soffite name..."
                                        required>
                                </div>

                                                                <!-- Soffite images: side-by-side layout -->
                                <div class="form-group">
                                    <label>Soffite images:</label>
                                    <small style="display:block; font-size:12px; color:#666; margin-bottom: 8px;">
                                        Max 2 images. Drag &amp; drop, browse, or paste (Ctrl+V).
                                    </small>

                                    <div style="display: flex; gap: 20px; align-items: flex-start;">
                                        <!-- Left: Image upload section -->
                                        <div class="image-upload-section soffite-image-upload" style="max-width: 200px; flex-shrink: 0;">
                                            <div class="upload-controls">
                                                <button
                                                    type="button"
                                                    class="camera-btn"
                                                    id="soffiteCameraBtn"
                                                    title="Upload Image">
                                                    <i class="fas fa-camera"></i>
                                                    Browse
                                                </button>
                                            </div>

                                            <input
                                                class="drop-zone"
                                                id="soffiteDropZone"
                                                placeholder="Drop or paste image here (Ctrl+V)"
                                                readonly
                                                tabindex="0">

                                            <div class="image-preview-container" id="soffiteImagePreviewContainer"></div>

                                            <input
                                                type="file"
                                                id="soffiteImageFileInput"
                                                accept="image/*"
                                                style="display: none;"
                                                multiple>
                                        </div>

                                        <!-- Right: Image descriptions -->
                                        <div style="flex: 1; display: flex; flex-direction: column; gap: 10px;">
                                            <div>
                                                <label for="soffiteImage1Desc" style="font-size: 13px;">Image description:</label>
                                                <input
                                                    type="text"
                                                    id="soffiteImage1Desc"
                                                    name="soffiteImage1Desc"
                                                    placeholder="Description for image 1..."
                                                    maxlength="50"
                                                    style="width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px;">
                                            </div>
                                            <div id="soffiteImage2DescContainer" style="display: none;">
                                                <label for="soffiteImage2Desc" style="font-size: 13px;">Image 2 description:</label>
                                                <input
                                                    type="text"
                                                    id="soffiteImage2Desc"
                                                    name="soffiteImage2Desc"
                                                    placeholder="Description for image 2..."
                                                    maxlength="50"
                                                    style="width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px;">
                                            </div>
                                        </div>
                                    </div>
                                </div>


                                <!-- Save / cancel buttons -->
                                <div style="display: flex; gap: 15px; margin-top: 20px;">
                                    <button
                                        type="submit"
                                        id="saveSoffite"
                                        style="background: #28a745; color: white; border: none; padding: 10px 15px; border-radius: 5px; cursor: pointer; font-size: 14px; flex: 1;">
                                        <i class="fas fa-save"></i> Save Soffite
                                    </button>
                                    <button
                                        type="button"
                                        id="cancelSoffite"
                                        style="background: #6c757d; color: white; border: none; padding: 10px 15px; border-radius: 5px; cursor: pointer; font-size: 14px; flex: 1;">
                                        Cancel
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- AWS Cognito SDK -->
    <script src="https://cdn.jsdelivr.net/npm/aws-sdk@2.1692.0/dist/aws-sdk.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/amazon-cognito-identity-js@6.3.15/dist/amazon-cognito-identity.min.js"></script>
    <script src="auth-helper.js"></script>
    <script src="limited-cfss-project-details.js"></script>
</body>
</html>